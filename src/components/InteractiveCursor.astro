<div
  id="cursor"
  class="pointer-events-none fixed top-0 left-0 z-100 hidden h-3 w-3 -translate-x-1/2 -translate-y-1/2 rounded-full bg-white mix-blend-difference transition-transform duration-100 ease-out md:block"
>
</div>
<div
  id="cursor-follower"
  class="pointer-events-none fixed top-0 left-0 z-99 hidden flex h-10 w-10 -translate-x-1/2 -translate-y-1/2 items-center justify-center rounded-full border border-white/30 mix-blend-difference transition-transform duration-300 ease-out md:block"
>
</div>

<script>
  import gsap from 'gsap';

  const cursor = document.getElementById('cursor');
  const follower = document.getElementById('cursor-follower');

  let mouseX = 0;
  let mouseY = 0;
  let cursorX = 0;
  let cursorY = 0;
  let followerX = 0;
  let followerY = 0;

  document.addEventListener('mousemove', (e) => {
    mouseX = e.clientX;
    mouseY = e.clientY;
  });

  gsap.ticker.add(() => {
    const dt = 1.0 - Math.pow(1.0 - 0.2, gsap.ticker.deltaRatio());
    const dtFollower = 1.0 - Math.pow(1.0 - 0.1, gsap.ticker.deltaRatio());

    cursorX += (mouseX - cursorX) * dt;
    cursorY += (mouseY - cursorY) * dt;

    followerX += (mouseX - followerX) * dtFollower;
    followerY += (mouseY - followerY) * dtFollower;

    if (cursor && follower) {
      cursor.style.transform = `translate3d(${cursorX}px, ${cursorY}px, 0)`;
      follower.style.transform = `translate3d(${followerX}px, ${followerY}px, 0)`;
    }
  });

  // Hover effects
  const hoverables = document.querySelectorAll('a, button, .magnetic');
  const crabTriggers = document.querySelectorAll('.crab-trigger');

  // Standard Hover
  hoverables.forEach((el) => {
    el.addEventListener('mouseenter', () => {
      gsap.to(cursor, { scale: 0 });
      gsap.to(follower, { scale: 1.5, backgroundColor: 'white', mixBlendMode: 'difference' });
    });

    el.addEventListener('mouseleave', () => {
      gsap.to(cursor, { scale: 1 });
      gsap.to(follower, { scale: 1, backgroundColor: 'transparent', mixBlendMode: 'difference' });
    });
  });

  // Crab Mode
  crabTriggers.forEach((el) => {
    el.addEventListener('mouseenter', () => {
      if (follower) {
        follower.innerText = 'ðŸ¦€';
        follower.style.fontSize = '32px';
        gsap.to(cursor, { scale: 0, duration: 0.6, ease: 'power3.out' });
        gsap.to(follower, {
          scale: 2,
          backgroundColor: 'transparent',
          borderColor: 'transparent',
          mixBlendMode: 'normal',
          duration: 0.8,
          ease: 'cubic-bezier(0.16, 1, 0.3, 1)',
        });
      }
    });

    el.addEventListener('mouseleave', () => {
      if (follower) {
        follower.innerText = '';
        follower.style.fontSize = '';
        gsap.to(cursor, { scale: 1, duration: 0.6, ease: 'power3.out' });
        gsap.to(follower, {
          scale: 1,
          backgroundColor: 'transparent',
          borderColor: 'rgba(255, 255, 255, 0.3)',
          mixBlendMode: 'difference',
          duration: 0.8,
          ease: 'cubic-bezier(0.16, 1, 0.3, 1)',
        });
      }
    });
  });
</script>
