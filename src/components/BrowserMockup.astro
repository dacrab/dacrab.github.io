---
import type { ImageMetadata } from 'astro';
import { Image } from 'astro:assets';

interface Props {
  src: ImageMetadata;
  alt: string;
  url?: string;
  class?: string;
}

const { src, alt, url, class: className } = Astro.props;
---

<div class:list={['browser-mockup group relative', className]}>
  <!-- Browser Chrome -->
  <div class="flex items-center gap-2 rounded-t-lg bg-zinc-800 px-4 py-3">
    <div class="flex gap-1.5">
      <span class="h-3 w-3 rounded-full bg-zinc-600"></span>
      <span class="h-3 w-3 rounded-full bg-zinc-600"></span>
      <span class="h-3 w-3 rounded-full bg-zinc-600"></span>
    </div>
    {url && (
      <div class="ml-4 flex-1 rounded-md bg-zinc-900 px-3 py-1">
        <span class="font-mono text-xs text-zinc-500 truncate block">{url}</span>
      </div>
    )}
  </div>

  <!-- Screen -->
  <div class="mockup-screen relative overflow-hidden rounded-b-lg bg-zinc-900">
    <Image
      src={src}
      alt={alt}
      class="mockup-image w-full"
      quality={90}
    />
  </div>
</div>

<script>
  import { addHoverAnimation, DURATION, EASE, isMobile } from '../utils/animations';

  if (!isMobile) {
    for (const mockup of document.querySelectorAll('.browser-mockup')) {
      const image = mockup.querySelector('.mockup-image');
      if (!image) continue;
      addHoverAnimation(mockup as Element, [
        {
          target: image,
          enter: { scale: 1.05, duration: DURATION.SLOW, ease: EASE.DEFAULT },
          leave: { scale: 1, duration: DURATION.SLOW, ease: EASE.DEFAULT },
        },
      ]);
    }
  }
</script>
